'use strict';const a9_0xdf6a1c=a9_0x1437;function a9_0x38cf(){const _0x4fab78=['extension','config','host','__esModule','generateDataCreate','generateMetadata','puppeteer','6156UnYPBz','close','launch','filename','uuid','from','readdir','promises','52842swtyaP','message','then','notFound','generateReplaceData','validate','utf8','not','3451mnDbpO','17672765dTVjPJ','default','apply','badRequest','next','81UGUgjM','converter','string','12RWkfLe','__awaiter','@hapi/boom','58690UOpiEO','replace','base64','unlink','1374305XWQeWx','2188191yYXYEF','convert','route','readFile','12jexfXH','toString','folder','newPage','ConverterService','throw','2825376xQKble','setJavaScriptEnabled'];a9_0x38cf=function(){return _0x4fab78;};return a9_0x38cf();}(function(_0xc3dad,_0x267507){const _0x183401=a9_0x1437,_0x2bce25=_0xc3dad();while(!![]){try{const _0x3316b6=parseInt(_0x183401(0x166))/0x1*(parseInt(_0x183401(0x177))/0x2)+parseInt(_0x183401(0x17f))/0x3+parseInt(_0x183401(0x183))/0x4*(parseInt(_0x183401(0x17e))/0x5)+parseInt(_0x183401(0x15e))/0x6*(parseInt(_0x183401(0x16e))/0x7)+-parseInt(_0x183401(0x189))/0x8+-parseInt(_0x183401(0x174))/0x9*(-parseInt(_0x183401(0x17a))/0xa)+-parseInt(_0x183401(0x16f))/0xb;if(_0x3316b6===_0x267507)break;else _0x2bce25['push'](_0x2bce25['shift']());}catch(_0x29d34b){_0x2bce25['push'](_0x2bce25['shift']());}}}(a9_0x38cf,0x72b7c));function a9_0x1437(_0x50dd2b,_0x574f81){const _0x38cfe6=a9_0x38cf();return a9_0x1437=function(_0x14376d,_0x6114c4){_0x14376d=_0x14376d-0x15d;let _0x176f1a=_0x38cfe6[_0x14376d];return _0x176f1a;},a9_0x1437(_0x50dd2b,_0x574f81);}var __awaiter=this&&this[a9_0xdf6a1c(0x178)]||function(_0x5dc4a8,_0x46b6e7,_0x327117,_0xcd70dd){function _0x5642a2(_0x27d861){return _0x27d861 instanceof _0x327117?_0x27d861:new _0x327117(function(_0x6db100){_0x6db100(_0x27d861);});}return new(_0x327117||(_0x327117=Promise))(function(_0x543233,_0x1214a2){const _0x459123=a9_0x1437;function _0x56ce5d(_0x534d62){const _0x4c8b6e=a9_0x1437;try{_0x3f4b95(_0xcd70dd[_0x4c8b6e(0x173)](_0x534d62));}catch(_0x4315d6){_0x1214a2(_0x4315d6);}}function _0x4bb73f(_0x3de587){const _0x467867=a9_0x1437;try{_0x3f4b95(_0xcd70dd[_0x467867(0x188)](_0x3de587));}catch(_0x506717){_0x1214a2(_0x506717);}}function _0x3f4b95(_0x583132){const _0x5f6715=a9_0x1437;_0x583132['done']?_0x543233(_0x583132['value']):_0x5642a2(_0x583132['value'])[_0x5f6715(0x168)](_0x56ce5d,_0x4bb73f);}_0x3f4b95((_0xcd70dd=_0xcd70dd[_0x459123(0x171)](_0x5dc4a8,_0x46b6e7||[]))['next']());});},__importDefault=this&&this['__importDefault']||function(_0x42fc9a){const _0x2610bb=a9_0xdf6a1c;return _0x42fc9a&&_0x42fc9a[_0x2610bb(0x18e)]?_0x42fc9a:{'default':_0x42fc9a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['ConverterService']=void 0x0;const handlebars_1=__importDefault(require('handlebars')),boom_1=__importDefault(require(a9_0xdf6a1c(0x179))),puppeteer_1=__importDefault(require(a9_0xdf6a1c(0x15d))),fs_1=require('fs'),config_1=require('../config'),uuid_1=require(a9_0xdf6a1c(0x162)),joi_1=__importDefault(require('joi'));class ConverterService{constructor(){}[a9_0xdf6a1c(0x18f)](_0x43f9bc){const _0x460da2=a9_0xdf6a1c;let {format:_0x2bcd13,width:_0x5a4d11,height:_0x488ee2,margin:_0x19587a}=_0x43f9bc;const _0x3b4771=''+(0x0,uuid_1['v4'])();return{'config':{'path':ConverterService['folder']+'/'+_0x3b4771+'.'+ConverterService[_0x460da2(0x18b)],'printBackground':!![],'format':_0x2bcd13,'width':_0x5a4d11,'height':_0x488ee2,'margin':_0x19587a},'filename':_0x3b4771};}[a9_0xdf6a1c(0x190)](_0x1d4307){const _0x2a6252=a9_0xdf6a1c;return{'url':config_1[_0x2a6252(0x18c)][_0x2a6252(0x18d)]+'/'+ConverterService['route']+'?file='+_0x1d4307,'filename':_0x1d4307};}['generateReplaceData'](_0x33473f){const _0x3ddc9d=a9_0xdf6a1c,_0x43ac86=Object['keys'](_0x33473f!==null&&_0x33473f!==void 0x0?_0x33473f:{});for(let _0x519ae7 of _0x43ac86){const {error:_0x6e361c}=joi_1[_0x3ddc9d(0x170)][_0x3ddc9d(0x176)]()[_0x3ddc9d(0x16d)]('')[_0x3ddc9d(0x17c)]()[_0x3ddc9d(0x16b)](_0x33473f[_0x519ae7]);if(_0x6e361c){_0x6e361c['message']=_0x6e361c[_0x3ddc9d(0x167)][_0x3ddc9d(0x17b)]('value',_0x519ae7);throw boom_1[_0x3ddc9d(0x170)][_0x3ddc9d(0x172)](_0x6e361c['message']);}const _0x279c7b=Buffer[_0x3ddc9d(0x163)](_0x33473f[_0x519ae7],'base64')[_0x3ddc9d(0x184)]('utf8');_0x33473f[_0x519ae7]=_0x279c7b;}return _0x33473f;}[a9_0xdf6a1c(0x180)](_0x42fd9c){var _0x5c0952;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x107511=a9_0x1437;try{const _0x597663=Buffer[_0x107511(0x163)](_0x42fd9c['html'],_0x107511(0x17c))['toString'](_0x107511(0x16c)),_0x77ea74=this[_0x107511(0x16a)]((_0x5c0952=_0x42fd9c[_0x107511(0x17b)])!==null&&_0x5c0952!==void 0x0?_0x5c0952:{});let _0x50a89f=handlebars_1[_0x107511(0x170)]['compile'](_0x597663,{'strict':!![]})(_0x77ea74);const _0x1c766c=yield puppeteer_1[_0x107511(0x170)][_0x107511(0x160)]({'headless':!![],'args':['--no-sandbox']}),_0x3d234f=yield _0x1c766c[_0x107511(0x186)]();yield _0x3d234f[_0x107511(0x18a)](![]),yield _0x3d234f['setContent'](_0x50a89f);const _0x2bbbe8=this[_0x107511(0x18f)](_0x42fd9c);return yield _0x3d234f['pdf'](_0x2bbbe8[_0x107511(0x18c)]),yield _0x1c766c[_0x107511(0x15f)](),this['generateMetadata'](_0x2bbbe8[_0x107511(0x161)]);}catch(_0xc0b0a8){throw boom_1[_0x107511(0x170)][_0x107511(0x172)](_0xc0b0a8[_0x107511(0x167)]);}});}['find'](_0x30590a){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3d864a=a9_0x1437;try{_0x30590a=_0x30590a+'.'+ConverterService[_0x3d864a(0x18b)];const _0x2da6f1=''+ConverterService[_0x3d864a(0x185)],_0x1d97a3=yield fs_1[_0x3d864a(0x165)][_0x3d864a(0x164)](_0x2da6f1),_0x33cf61=_0x1d97a3['find'](_0x470da8=>_0x470da8===_0x30590a);if(!_0x33cf61)throw'';const _0x4bbdfc=_0x2da6f1+'/'+_0x30590a,_0x295be1=yield fs_1[_0x3d864a(0x165)][_0x3d864a(0x182)](_0x4bbdfc)['catch'](_0xf7bcab=>{throw'';});return fs_1[_0x3d864a(0x165)][_0x3d864a(0x17d)](_0x4bbdfc),_0x295be1;}catch(_0x41684e){throw boom_1['default'][_0x3d864a(0x169)]('File\x20not\x20found');}});}}exports[a9_0xdf6a1c(0x187)]=ConverterService,ConverterService[a9_0xdf6a1c(0x185)]=__dirname+'/../pdf',ConverterService[a9_0xdf6a1c(0x181)]=a9_0xdf6a1c(0x175),ConverterService[a9_0xdf6a1c(0x18b)]='pdf';